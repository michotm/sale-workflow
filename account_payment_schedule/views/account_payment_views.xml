<?xml version="1.0" encoding="utf-8"?>
<!-- Copyright 2021 Akretion
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl). -->

<odoo>

    <record id="view_account_payment_form" model="ir.ui.view" >
        <field name="name">account.payment.form (in account_payment_schedule)</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">

            <xpath expr="//button[@name='action_post']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('state', '!=', 'draft'), ('is_action_post_visible', '=', False)]}</attribute>
            </xpath>
            <xpath expr="//group[@name='group3']" position="inside">
                <field name="is_advance" attrs="{'invisible': [('purchase_id', '=', False), ('sale_id', '=', False)]}"/>
                <field name="is_action_post_visible" invisible="1" />
            </xpath>
        </field>
    </record>

    <record id="view_purchase_advance_payment_tree" model="ir.ui.view">
      <field name="name">account.payment.tree (in account_payment_schedule)</field>
      <field name="model">account.payment</field>
      <field name="inherit_id" ref="purchase_advance_payment.view_purchase_advance_payment_tree"/>
      <field name="arch" type="xml">
          <xpath expr="//tree" position="attributes">
              <attribute name="decoration-muted">not is_advance</attribute>
              <attribute name="default_order">is_advance desc, date</attribute>
          </xpath>
          <xpath expr="//tree" position="inside">
              <field name="is_advance" invisible="1"/>
          </xpath>
      </field>
    </record>

    <record id="view_sale_advance_payment_tree" model="ir.ui.view">
      <field name="name">account.payment.tree (in account_payment_schedule)</field>
      <field name="model">account.payment</field>
      <field name="inherit_id" ref="sale_advance_payment.view_sale_advance_payment_tree"/>
      <field name="arch" type="xml">
          <xpath expr="//tree" position="attributes">
              <attribute name="decoration-muted">not is_advance</attribute>
              <attribute name="default_order">is_advance desc, date</attribute>
          </xpath>
          <xpath expr="//tree" position="inside">
              <field name="is_advance" invisible="1"/>
          </xpath>
      </field>
    </record>


</odoo>
